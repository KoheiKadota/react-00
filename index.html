<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/sample.css" />
    <title>ã˜ã‚ƒã‚“ã‘ã‚“</title>
  </head>

  <body>
    <header>
      <h1>å¾©è®ã˜ã‚ƒã‚“ã‘ã‚“</h1>
    </header>

    <main>
      <ul>
        <li id="gu_btn">ã‚°ãƒ¼</li>
        <li id="cho_btn">ãƒãƒ§ã‚­</li>
        <li id="par_btn">ãƒ‘ãƒ¼</li>
      </ul>
      <div class="hand_result">
      <div id="com_hand">ğŸ¤–</div>
      <div id="result">ğŸ™Œ</div>
      </div>

    </main>

    <footer>è² ã‘ã‚‹ãªï¼ç”·ã ã‚ï¼</footer>

    <!-- $("#idå").classå -->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>
      //ã‚°ãƒ¼ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸæ™‚
      $("#gu_btn").on("click", function () {
        const min = 0;
        const max = 2;
        const randomNumber = Math.floor(Math.random() * (max - min + 1)) + min;

        // letã§ç·¨é›†ã®åˆæœŸåŒ–
        let win = 0; //å‹ã£ãŸå ´åˆ
        let lose = 0; //è² ã‘ãŸå ´åˆ
        let draw = 0; //ã‚ã„ã“ã®å ´åˆ

        // ä¹±æ•°ã®æŒ‡ç¤ºã‚’å‡ºã™
        console.log(randomNumber);

        if (randomNumber === 0) {
          $("#com_hand").text("ã‚°ãƒ¼");
          $("#result").text("ã‚ã„ã“");
          draw++; // ã‚ã„ã“ã‚’1ã¤ã‚«ã‚¦ãƒ³ãƒˆ
        }

        if (randomNumber === 1) {
          $("#com_hand").text("ãƒãƒ§ã‚­");
          $("#result").text("ã‚ãªãŸã®å‹ã¡");
          win++; // å‹ã¡ã‚’1ã¤ã‚«ã‚¦ãƒ³ãƒˆ
        }
        if (randomNumber === 2) {
          $("#com_hand").text("ãƒ‘ãƒ¼");
          $("#result").text("ã‚ãªãŸã®è² ã‘");
          lose++; // è² ã‘ã‚’1ã¤ã‚«ã‚¦ãƒ³ãƒˆ
        }
      });

      // ãƒãƒ§ã‚­ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸæ™‚
      $("#cho_btn").on("click", function () {
        const min = 0;
        const max = 2;
        const randomNumber = Math.floor(Math.random() * (max - min + 1)) + min;

        // letã§ç·¨é›†ã®åˆæœŸåŒ–
        let win = 0; //å‹ã£ãŸå ´åˆ
        let lose = 0; //è² ã‘ãŸå ´åˆ
        let draw = 0; //ã‚ã„ã“ã®å ´åˆ

        // ä¹±æ•°ã®æŒ‡ç¤ºã‚’å‡ºã™
        console.log(randomNumber);

        if (randomNumber === 0) {
          $("#com_hand").text("ã‚°ãƒ¼");
          $("#result").text("ã‚ãªãŸã®è² ã‘");
          lose++; // è² ã‘ã‚’1ã¤ã‚«ã‚¦ãƒ³ãƒˆ
        }
        if (randomNumber === 1) {
          $("#com_hand").text("ãƒãƒ§ã‚­");
          $("#result").text("ã‚ã„ã“");
          draw++; // ã‚ã„ã“ã‚’1ã¤ã‚«ã‚¦ãƒ³ãƒˆ
        }
        if (randomNumber === 2) {
          $("#com_hand").text("ãƒ‘ãƒ¼");
          $("#result").text("ã‚ãªãŸã®å‹ã¡");
          win++; // å‹ã¡ã‚’1ã¤ã‚«ã‚¦ãƒ³ãƒˆ
        }
      });

      // ãƒ‘ãƒ¼ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸæ™‚
      $("#par_btn").on("click", function () {
        const min = 0;
        const max = 2;
        const randomNumber = Math.floor(Math.random() * (max - min + 1)) + min;

        // letã§ç·¨é›†ã®åˆæœŸåŒ–
        let win = 0; //å‹ã£ãŸå ´åˆ
        let lose = 0; //è² ã‘ãŸå ´åˆ
        let draw = 0; //ã‚ã„ã“ã®å ´åˆ

        // ä¹±æ•°ã®æŒ‡ç¤ºã‚’å‡ºã™
        console.log(randomNumber);

        if (randomNumber === 0) {
          $("#com_hand").text("ã‚°ãƒ¼");
          $("#result").text("ã‚ãªãŸã®å‹ã¡");
          win++; // å‹ã¡ã‚’1ã¤ã‚«ã‚¦ãƒ³ãƒˆ
        }
        if (randomNumber === 1) {
          $("#com_hand").text("ãƒãƒ§ã‚­");
          $("#result").text("ã‚ãªãŸã®è² ã‘");
          lose++; // è² ã‘ã‚’1ã¤ã‚«ã‚¦ãƒ³ãƒˆ
        }
        if (randomNumber === 2) {
          $("#com_hand").text("ãƒ‘ãƒ¼");
          $("#result").text("ã‚ã„ã“");
          draw++; // ã‚ã„ã“ã‚’1ã¤ã‚«ã‚¦ãƒ³ãƒˆ
        }
      });
    </script>



<h2>Reactå‚è€ƒæ›¸(Amazonã®ã‚ªã‚¹ã‚¹ãƒ¡)</h2>
<div id="output"></div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!-- axiosãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ -->
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

<script>
  // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹urlã‚’æº–å‚™
  const url = 'https://www.googleapis.com/books/v1/volumes?q=intitle:react';

  axios.get(url)
    .then(function (response) {

      console.log(response.data.items[1].volumeInfo);
      const array = [];
      for (let i = 0; i < response.data.items.length; i++) {
        array.push(`<a href="${response.data.items[i].volumeInfo.infoLink}"><p>${response.data.items[i].volumeInfo.title}</p><a>`)
      }

      $('#output').html(array);
    })
    .catch(function (error) {

      console.log(error);
    })

</script>


<h3>realtime chat</h3>
<!-- å…¥åŠ›å ´æ‰€ã‚’ä½œæˆ -->
<form>
  <fieldset>
    <legend>ãƒãƒ£ãƒƒãƒˆå…¥åŠ›ç”»é¢</legend>
    <div>
      name: <input type="text" id="name">
    </div>
    <div>
      text: <input type="text" id="text">
    </div>
    <div>
      <button type="button" id="send">send</button>
    </div>
  </fieldset>
</form>

<!-- ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›å ´æ‰€ -->
<ul id="output"></ul>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
  // æ—¥æ™‚ã‚’ã„ã„æ„Ÿã˜ã®å½¢å¼ã«ã™ã‚‹é–¢æ•°
  function convertTimestampToDatetime(timestamp) {
    const _d = timestamp ? new Date(timestamp * 1000) : new Date();
    const Y = _d.getFullYear();
    const m = (_d.getMonth() + 1).toString().padStart(2, '0');
    const d = _d.getDate().toString().padStart(2, '0');
    const H = _d.getHours().toString().padStart(2, '0');
    const i = _d.getMinutes().toString().padStart(2, '0');
    const s = _d.getSeconds().toString().padStart(2, '0');
    return `${Y}/${m}/${d} ${H}:${i}:${s}`;
  }
</script>
<!-- ä»¥ä¸‹ã«firebaseã®ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã‚ˆã† -->
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.3.0/firebase-app.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  import {
    getFirestore,
    collection,
    addDoc,
    serverTimestamp,
    onSnapshot,
  } from "https://www.gstatic.com/firebasejs/10.3.0/firebase-firestore.js";


  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "",
    authDomain: "react-cec3c.firebaseapp.com",
    projectId: "react-cec3c",
    storageBucket: "react-cec3c.appspot.com",
    messagingSenderId: "300952780414",
    appId: "1:300952780414:web:a2a42adbcde59d6ae4622f"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // é€ä¿¡æ™‚ã«å¿…è¦ãªå‡¦ç†
  $("#send").on("click", function () {
    const postData = {
      name: $("#name").val(),
      text: $("#text").val(),
      time: serverTimestamp(),
    };
    addDoc(collection(db, "chat"), postData);
    $("#text").val("");
  });

  // ãƒ‡ãƒ¼ã‚¿å–å¾—å‡¦ç†
  onSnapshot(collection(db, "chat"), (querySnapshot) => {
    console.log(querySnapshot.docs);

    // ãƒ‡ãƒ¼ã‚¿å–å¾—æ¡ä»¶ã®æŒ‡å®šï¼ˆä»Šå›ã¯æ™‚é–“ã®æ–°ã—ã„é †ã«ä¸¦ã³æ›¿ãˆã¦å–å¾—ï¼‰
    const q = query(collection(db, "chat"), orderBy("time", "desc"));

    onSnapshot(q, (querySnapshot) => {

      const documents = [];
      querySnapshot.docs.forEach(function (doc) {
        const document = {
          id: doc.id,
          data: doc.data(),
        };
        documents.push(document);
      });

      console.log(documents);

      const htmlElements = [];
      documents.forEach(function (document) {
        htmlElements.push(`
    <li id="${document.id}">
      <p>${document.data.name
          } at ${convertTimestampToDatetime(document.data.time.seconds)}</p> 
      <p>${document.data.text}</p>
    </li>
  `);
      });

      $("#output").html(htmlElements);
    });

  });

</script>



  </body>
</html>

